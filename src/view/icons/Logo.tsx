import React from 'react'
import {StyleSheet, TextProps} from 'react-native'
import Svg, {
  Defs,
  LinearGradient,
  Path,
  PathProps,
  Stop,
  SvgProps,
} from 'react-native-svg'
import {Image} from 'expo-image'

import {useKawaiiMode} from '#/state/preferences/kawaii'

const ratio = 57 / 64

type Props = {
  fill?: PathProps['fill']
  style?: TextProps['style']
} & Omit<SvgProps, 'style'>

export const Logo = React.forwardRef(function LogoImpl(props: Props, ref) {
  const {fill, ...rest} = props
  const gradient = fill === 'sky'
  const styles = StyleSheet.flatten(props.style)
  const _fill = gradient ? 'url(#sky)' : fill || styles?.color || '#00ae62'
  // @ts-ignore it's fiiiiine
  const size = parseInt(rest.width || 32)

  const isKawaii = useKawaiiMode()

  if (isKawaii) {
    return (
      <Image
        source={
          size > 100
            ? require('../../../assets/kawaii.png')
            : require('../../../assets/kawaii_smol.png')
        }
        accessibilityLabel="Bluesky"
        accessibilityHint=""
        accessibilityIgnoresInvertColors
        style={[{height: size, aspectRatio: 1.4}]}
      />
    )
  }

  return (
    <Svg
      fill="none"
      // @ts-ignore it's fiiiiine
      ref={ref}
      viewBox="0 0 57 54"
      {...rest}
      style={[{width: size, height: size * ratio}, styles]}>
      {gradient && (
        <Defs>
          <LinearGradient id="sky" x1="0" y1="0" x2="0" y2="1">
            <Stop offset="0" stopColor="#0A7AFF" stopOpacity="1" />
            <Stop offset="1" stopColor="#59B9FF" stopOpacity="1" />
          </LinearGradient>
        </Defs>
      )}

      <Path
        fill={_fill}
        d="M 25.3639 0.8403 C 24.6857 1.4898 23.8985 3.0594 21.7818 8.0378 C 20.2937 11.5442 18.966 14.6659 18.8386 14.9828 C 18.671 15.3847 18.1944 15.6782 17.2632 15.948 C 16.5284 16.1612 14.8365 16.4424 13.5053 16.575 C 12.1704 16.7073 9.134 17.0049 6.7491 17.2349 C 3.2642 17.5753 2.2478 17.7648 1.5471 18.2022 C 1.0695 18.5004 0.5224 18.9717 0.3384 19.2532 C 0.1312 19.5588 -0.0057 20.4671 0.0002 21.5485 L 0.0055 23.3303 C 2.8615 26.1066 4.6679 27.7222 5.8584 28.7104 C 7.048 29.7002 8.9211 31.3612 10.0254 32.4023 C 12.0039 34.2768 12.0206 34.2984 12.0151 35.5642 C 12.0096 36.2653 11.8761 37.35 11.7275 37.9831 C 11.5722 38.6161 11.2846 39.9319 11.0836 40.9161 C 10.8824 41.8934 10.3427 44.5088 9.8828 46.728 L 9.0429 50.7576 C 10.0824 52.7062 10.6471 53.3156 11.2107 53.6094 C 11.8538 53.9372 12.5321 54.0467 13.6299 53.9822 C 14.9983 53.9143 15.3954 53.7467 17.3907 52.4419 C 18.6145 51.6378 19.7074 50.9822 19.8109 50.9877 C 19.9201 50.993 20.2295 50.7576 20.5123 50.4697 C 20.7937 50.1826 21.1093 49.9471 21.2137 49.9526 C 21.3166 49.9582 22.2927 49.3894 23.3798 48.6884 C 24.4668 47.9931 25.8982 47.1311 26.5647 46.7794 C 27.2317 46.429 28.0031 46.1413 28.2848 46.1413 C 28.5655 46.1413 29.5081 46.6364 30.3883 47.2393 C 31.2619 47.8436 32.7288 48.7508 33.6364 49.2569 C 34.5509 49.7572 35.4652 50.3554 35.6777 50.5847 C 35.8844 50.8153 36.1435 50.9996 36.2465 50.993 C 36.3559 50.9877 37.0981 51.4006 37.9082 51.9131 C 38.7127 52.4248 39.7135 53.0747 40.132 53.3557 C 40.6207 53.6843 41.4606 53.9077 42.4276 53.9715 C 43.5587 54.0467 44.1911 53.9489 44.8522 53.6094 C 45.4683 53.2869 45.9281 52.7534 46.3477 51.8732 L 46.9563 50.5964 C 46.2905 47.2393 45.9336 45.5207 45.7432 44.6126 C 45.5539 43.6991 45.2092 42.0367 44.9857 40.9161 C 44.7556 39.7941 44.4741 38.4721 44.3472 37.9831 C 44.226 37.4953 44.0537 36.5183 43.9609 35.8172 L 43.7901 34.5455 C 47.2788 31.3382 49.6656 29.2046 51.3491 27.7394 C 53.0332 26.2744 54.7808 24.6514 55.2353 24.1399 C 55.995 23.2779 56.0631 23.0595 56.0631 21.4846 C 56.0696 20.3683 55.9308 19.5588 55.6834 19.1904 C 55.4708 18.8746 54.868 18.3972 54.3441 18.1321 C 53.8039 17.8625 52.2803 17.5293 50.8381 17.3622 C 49.4357 17.2012 46.8588 16.9541 45.1047 16.8113 C 43.3528 16.6665 40.9553 16.3512 39.7765 16.1157 C 38.5111 15.8612 37.5517 15.5284 37.4249 15.3039 C 37.3048 15.092 36.161 12.4527 34.8838 9.4404 C 33.6025 6.4285 32.2393 3.3294 31.8605 2.5594 C 31.475 1.7882 30.8305 0.8968 30.4225 0.5755 C 29.8195 0.0983 29.3826 -0.006 27.9626 0.0003 C 26.3688 0.0114 26.1687 0.0757 25.3639 0.8403 Z"
      />
    </Svg>
  )
})
